Now you should run one of the following depending on your shell
source /share/apps/python/anaconda3.2019.3/etc/profile.d/conda.sh
source /share/apps/python/anaconda3.2019.3/etc/profile.d/conda.csh
Running model_type=cke on all datasetsFri Jan  8 14:44:58 PST 2021
Running model_type=cke on dataset=amazon-book
Num cores: 20
[n_users, n_items]=[70679, 24915]
[n_train, n_test]=[652514, 193920]
[n_entities, n_relations, n_triples]=[113487, 39, 2557746]
[batch_size, batch_size_kg]=[1024, 4015]
load the pretrained bprmf model parameters.
using pretrained initialization
#params: 13543424
without pretraining.
Epoch 0 [104.6s]: train==[222.91160=21.59385 + 101.33706 + 99.98069]
Epoch 9 [105.1s + 55.9s]: train==[196.03853=21.47123 + 74.76659 + 99.80072], recall=[0.13109, 0.29890], precision=[0.01387, 0.00694], hit=[0.23098, 0.46857], ndcg=[0.08912, 0.14368]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 19 [105.5s + 53.8s]: train==[194.22132=21.41153 + 73.08162 + 99.72817], recall=[0.13038, 0.30013], precision=[0.01377, 0.00698], hit=[0.22915, 0.47009], ndcg=[0.08833, 0.14351]
Epoch 29 [106.1s + 54.9s]: train==[193.44025=21.17422 + 72.57693 + 99.68910], recall=[0.12982, 0.30094], precision=[0.01371, 0.00699], hit=[0.22874, 0.47092], ndcg=[0.08790, 0.14347]
Epoch 39 [104.7s + 54.7s]: train==[193.20387=21.29653 + 72.23065 + 99.67669], recall=[0.12994, 0.30044], precision=[0.01372, 0.00698], hit=[0.22860, 0.47080], ndcg=[0.08858, 0.14397]
Epoch 49 [106.5s + 54.9s]: train==[192.81646=21.13096 + 72.04588 + 99.63962], recall=[0.13116, 0.30143], precision=[0.01385, 0.00701], hit=[0.23094, 0.47251], ndcg=[0.08848, 0.14394]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 50 [106.4s]: train==[192.79156=21.13062 + 72.02560 + 99.63533]
Epoch 59 [105.9s + 53.5s]: train==[192.49513=20.97008 + 71.91000 + 99.61505], recall=[0.13161, 0.30186], precision=[0.01393, 0.00701], hit=[0.23203, 0.47252], ndcg=[0.08933, 0.14464]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 69 [105.2s + 55.1s]: train==[192.55788=21.11864 + 71.82634 + 99.61290], recall=[0.13171, 0.30298], precision=[0.01388, 0.00705], hit=[0.23153, 0.47396], ndcg=[0.08851, 0.14411]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 79 [110.8s + 83.2s]: train==[192.30729=20.98390 + 71.73668 + 99.58672], recall=[0.13233, 0.30352], precision=[0.01392, 0.00705], hit=[0.23240, 0.47490], ndcg=[0.08888, 0.14456]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 89 [106.7s + 54.8s]: train==[192.16047=20.94490 + 71.64193 + 99.57364], recall=[0.13147, 0.30291], precision=[0.01385, 0.00704], hit=[0.23099, 0.47445], ndcg=[0.08886, 0.14452]
Epoch 99 [108.2s + 53.8s]: train==[192.10162=20.97122 + 71.57282 + 99.55759], recall=[0.13217, 0.30308], precision=[0.01396, 0.00703], hit=[0.23278, 0.47472], ndcg=[0.08908, 0.14473]
Epoch 100 [106.8s]: train==[192.16806=21.04291 + 71.55544 + 99.56971]
Epoch 109 [105.1s + 55.0s]: train==[192.07519=21.02432 + 71.48859 + 99.56228], recall=[0.13257, 0.30413], precision=[0.01397, 0.00706], hit=[0.23296, 0.47577], ndcg=[0.08943, 0.14512]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 119 [106.0s + 109.8s]: train==[191.81780=20.78434 + 71.49375 + 99.53971], recall=[0.13210, 0.30525], precision=[0.01391, 0.00709], hit=[0.23237, 0.47730], ndcg=[0.08885, 0.14502]
Epoch 129 [109.8s + 54.4s]: train==[191.85023=20.84831 + 71.46801 + 99.53391], recall=[0.13269, 0.30549], precision=[0.01398, 0.00709], hit=[0.23350, 0.47778], ndcg=[0.08945, 0.14549]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 139 [108.5s + 92.5s]: train==[191.75929=20.79532 + 71.43865 + 99.52532], recall=[0.13361, 0.30550], precision=[0.01408, 0.00709], hit=[0.23476, 0.47669], ndcg=[0.09049, 0.14628]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 149 [104.4s + 54.8s]: train==[191.75888=20.82759 + 71.39830 + 99.53298], recall=[0.13267, 0.30533], precision=[0.01400, 0.00708], hit=[0.23370, 0.47730], ndcg=[0.08913, 0.14514]
Epoch 150 [106.3s]: train==[191.71914=20.83382 + 71.36911 + 99.51622]
Epoch 159 [105.8s + 100.5s]: train==[191.62434=20.77717 + 71.35509 + 99.49208], recall=[0.13201, 0.30592], precision=[0.01389, 0.00710], hit=[0.23194, 0.47860], ndcg=[0.08895, 0.14538]
Epoch 169 [109.0s + 54.0s]: train==[191.60516=20.76546 + 71.33910 + 99.50061], recall=[0.13232, 0.30502], precision=[0.01396, 0.00707], hit=[0.23323, 0.47727], ndcg=[0.08913, 0.14508]
Epoch 179 [106.8s + 82.9s]: train==[191.45128=20.67280 + 71.29047 + 99.48801], recall=[0.13219, 0.30582], precision=[0.01393, 0.00710], hit=[0.23288, 0.47822], ndcg=[0.08931, 0.14559]
Epoch 189 [105.4s + 54.7s]: train==[191.33931=20.63612 + 71.23994 + 99.46326], recall=[0.13254, 0.30658], precision=[0.01395, 0.00711], hit=[0.23305, 0.47937], ndcg=[0.08950, 0.14590]
Epoch 199 [106.5s + 109.6s]: train==[191.35337=20.62957 + 71.25914 + 99.46466], recall=[0.13291, 0.30721], precision=[0.01402, 0.00713], hit=[0.23398, 0.47992], ndcg=[0.08932, 0.14580]
Epoch 200 [108.1s]: train==[191.57038=20.86807 + 71.23720 + 99.46512]
Epoch 209 [107.1s + 54.9s]: train==[191.41230=20.75078 + 71.21107 + 99.45045], recall=[0.13397, 0.30717], precision=[0.01412, 0.00712], hit=[0.23584, 0.48032], ndcg=[0.08993, 0.14608]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 219 [109.2s + 59.6s]: train==[191.27318=20.60806 + 71.20742 + 99.45770], recall=[0.13306, 0.30741], precision=[0.01401, 0.00714], hit=[0.23411, 0.48081], ndcg=[0.08983, 0.14636]
Epoch 229 [108.7s + 55.0s]: train==[191.27425=20.62459 + 71.20170 + 99.44796], recall=[0.13415, 0.30830], precision=[0.01413, 0.00715], hit=[0.23551, 0.48158], ndcg=[0.08996, 0.14640]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 239 [108.0s + 54.0s]: train==[191.24126=20.59170 + 71.18646 + 99.46311], recall=[0.13297, 0.30862], precision=[0.01401, 0.00716], hit=[0.23371, 0.48180], ndcg=[0.08980, 0.14670]
Epoch 249 [105.6s + 54.2s]: train==[191.17740=20.58818 + 71.15161 + 99.43761], recall=[0.13467, 0.30787], precision=[0.01419, 0.00713], hit=[0.23708, 0.48084], ndcg=[0.08973, 0.14577]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 250 [107.7s]: train==[191.20194=20.57803 + 71.18498 + 99.43894]
Epoch 259 [104.7s + 55.1s]: train==[191.30388=20.69240 + 71.17754 + 99.43394], recall=[0.13320, 0.30752], precision=[0.01407, 0.00713], hit=[0.23468, 0.48032], ndcg=[0.08943, 0.14579]
Epoch 269 [107.8s + 54.6s]: train==[191.04858=20.52810 + 71.11552 + 99.40496], recall=[0.13316, 0.30811], precision=[0.01404, 0.00714], hit=[0.23446, 0.48131], ndcg=[0.08908, 0.14566]
Epoch 279 [105.9s + 55.1s]: train==[191.10738=20.57620 + 71.13136 + 99.39982], recall=[0.13253, 0.30849], precision=[0.01394, 0.00715], hit=[0.23317, 0.48155], ndcg=[0.08828, 0.14523]
Epoch 289 [104.0s + 54.4s]: train==[191.13633=20.56714 + 71.16025 + 99.40894], recall=[0.13401, 0.30960], precision=[0.01411, 0.00716], hit=[0.23604, 0.48305], ndcg=[0.09018, 0.14684]
Epoch 299 [106.6s + 55.0s]: train==[191.02444=20.49129 + 71.14911 + 99.38404], recall=[0.13380, 0.30913], precision=[0.01408, 0.00716], hit=[0.23538, 0.48179], ndcg=[0.08943, 0.14606]
Epoch 300 [107.3s]: train==[191.01631=20.49159 + 71.13857 + 99.38615]
Epoch 309 [106.0s + 54.5s]: train==[190.94852=20.48931 + 71.06032 + 99.39889], recall=[0.13281, 0.30848], precision=[0.01393, 0.00714], hit=[0.23334, 0.48195], ndcg=[0.08914, 0.14600]
Epoch 319 [106.9s + 54.3s]: train==[190.90833=20.43842 + 71.09024 + 99.37968], recall=[0.13476, 0.30905], precision=[0.01417, 0.00716], hit=[0.23747, 0.48284], ndcg=[0.09001, 0.14652]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 329 [108.9s + 55.1s]: train==[190.92043=20.46496 + 71.07714 + 99.37833], recall=[0.13488, 0.30903], precision=[0.01419, 0.00716], hit=[0.23735, 0.48255], ndcg=[0.09021, 0.14670]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 339 [107.6s + 55.1s]: train==[190.90471=20.45331 + 71.09335 + 99.35805], recall=[0.13385, 0.30886], precision=[0.01406, 0.00715], hit=[0.23507, 0.48260], ndcg=[0.08889, 0.14563]
Epoch 349 [103.3s + 55.1s]: train==[190.94507=20.48044 + 71.08937 + 99.37526], recall=[0.13355, 0.30922], precision=[0.01403, 0.00716], hit=[0.23459, 0.48352], ndcg=[0.08915, 0.14614]
Epoch 350 [106.9s]: train==[190.81967=20.40553 + 71.06854 + 99.34560]
Epoch 359 [105.8s + 54.5s]: train==[190.91282=20.46326 + 71.08560 + 99.36397], recall=[0.13528, 0.31033], precision=[0.01420, 0.00718], hit=[0.23737, 0.48401], ndcg=[0.09024, 0.14693]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 369 [105.5s + 54.9s]: train==[190.74770=20.33819 + 71.05043 + 99.35908], recall=[0.13402, 0.30892], precision=[0.01410, 0.00715], hit=[0.23609, 0.48308], ndcg=[0.08938, 0.14606]
Epoch 379 [105.4s + 55.0s]: train==[190.85419=20.43754 + 71.07812 + 99.33852], recall=[0.13409, 0.30870], precision=[0.01405, 0.00715], hit=[0.23526, 0.48202], ndcg=[0.09004, 0.14661]
Epoch 389 [106.0s + 55.9s]: train==[190.81908=20.44058 + 71.02411 + 99.35438], recall=[0.13422, 0.31019], precision=[0.01411, 0.00718], hit=[0.23643, 0.48440], ndcg=[0.09034, 0.14733]
Epoch 399 [104.5s + 55.2s]: train==[190.67711=20.31216 + 71.01964 + 99.34531], recall=[0.13436, 0.31021], precision=[0.01411, 0.00718], hit=[0.23613, 0.48417], ndcg=[0.08967, 0.14669]
Epoch 400 [103.2s]: train==[190.71113=20.34378 + 71.03356 + 99.33378]
Epoch 409 [108.1s + 55.5s]: train==[190.82740=20.47467 + 71.02448 + 99.32825], recall=[0.13416, 0.31007], precision=[0.01407, 0.00718], hit=[0.23492, 0.48434], ndcg=[0.09000, 0.14704]
Epoch 419 [105.9s + 54.5s]: train==[190.63091=20.32659 + 70.97919 + 99.32514], recall=[0.13488, 0.31008], precision=[0.01415, 0.00717], hit=[0.23638, 0.48414], ndcg=[0.08966, 0.14644]
Epoch 429 [105.8s + 54.3s]: train==[190.63102=20.32807 + 70.97878 + 99.32417], recall=[0.13449, 0.31025], precision=[0.01412, 0.00718], hit=[0.23638, 0.48476], ndcg=[0.09002, 0.14696]
Epoch 439 [108.1s + 54.2s]: train==[190.60906=20.25234 + 71.04374 + 99.31298], recall=[0.13531, 0.31027], precision=[0.01425, 0.00718], hit=[0.23805, 0.48447], ndcg=[0.09077, 0.14747]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 449 [106.1s + 55.2s]: train==[190.63152=20.32270 + 70.99023 + 99.31858], recall=[0.13512, 0.31056], precision=[0.01417, 0.00718], hit=[0.23677, 0.48474], ndcg=[0.08959, 0.14653]
Epoch 450 [107.7s]: train==[190.56742=20.28602 + 70.96629 + 99.31511]
Epoch 459 [108.8s + 54.4s]: train==[190.59351=20.31757 + 70.96602 + 99.30991], recall=[0.13474, 0.31127], precision=[0.01415, 0.00721], hit=[0.23633, 0.48546], ndcg=[0.08980, 0.14701]
Epoch 469 [107.1s + 55.5s]: train==[190.60294=20.27942 + 71.03349 + 99.29002], recall=[0.13480, 0.31092], precision=[0.01415, 0.00719], hit=[0.23680, 0.48584], ndcg=[0.08964, 0.14674]
Epoch 479 [109.2s + 55.1s]: train==[190.59525=20.30252 + 71.00120 + 99.29153], recall=[0.13411, 0.31029], precision=[0.01411, 0.00718], hit=[0.23626, 0.48485], ndcg=[0.08955, 0.14678]
Epoch 489 [108.4s + 55.3s]: train==[190.54307=20.26112 + 70.98738 + 99.29457], recall=[0.13460, 0.31134], precision=[0.01414, 0.00721], hit=[0.23696, 0.48559], ndcg=[0.08999, 0.14716]
Epoch 499 [104.6s + 55.2s]: train==[190.48639=20.20628 + 70.98997 + 99.29013], recall=[0.13490, 0.31093], precision=[0.01418, 0.00720], hit=[0.23655, 0.48587], ndcg=[0.09032, 0.14747]
Epoch 500 [106.1s]: train==[190.46248=20.21528 + 70.97438 + 99.27282]
Epoch 509 [105.6s + 55.0s]: train==[190.54103=20.29737 + 70.98306 + 99.26060], recall=[0.13407, 0.31221], precision=[0.01408, 0.00722], hit=[0.23626, 0.48683], ndcg=[0.09016, 0.14767]
Epoch 519 [106.4s + 114.9s]: train==[190.43544=20.17912 + 70.98376 + 99.27257], recall=[0.13604, 0.31118], precision=[0.01431, 0.00720], hit=[0.23929, 0.48544], ndcg=[0.09073, 0.14748]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 529 [108.1s + 54.8s]: train==[190.40680=20.17202 + 70.95149 + 99.28329], recall=[0.13484, 0.31235], precision=[0.01416, 0.00723], hit=[0.23680, 0.48690], ndcg=[0.08952, 0.14689]
Epoch 539 [105.6s + 54.2s]: train==[190.40602=20.23778 + 70.90708 + 99.26115], recall=[0.13489, 0.31206], precision=[0.01419, 0.00722], hit=[0.23775, 0.48727], ndcg=[0.09105, 0.14839]
Epoch 549 [106.4s + 55.2s]: train==[190.36285=20.17260 + 70.92400 + 99.26625], recall=[0.13351, 0.31251], precision=[0.01400, 0.00723], hit=[0.23506, 0.48761], ndcg=[0.08922, 0.14712]
Epoch 550 [104.0s]: train==[190.45577=20.23410 + 70.95346 + 99.26821]
Epoch 559 [108.0s + 56.3s]: train==[190.40857=20.26437 + 70.89970 + 99.24450], recall=[0.13510, 0.31196], precision=[0.01419, 0.00722], hit=[0.23742, 0.48716], ndcg=[0.08999, 0.14733]
Epoch 569 [107.2s + 55.1s]: train==[190.38893=20.13192 + 71.01546 + 99.24155], recall=[0.13609, 0.31246], precision=[0.01430, 0.00724], hit=[0.23908, 0.48773], ndcg=[0.09089, 0.14812]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 579 [103.5s + 54.4s]: train==[190.33952=20.15751 + 70.93188 + 99.25014], recall=[0.13466, 0.31174], precision=[0.01414, 0.00721], hit=[0.23657, 0.48733], ndcg=[0.09049, 0.14790]
Epoch 589 [105.9s + 55.5s]: train==[190.38131=20.16236 + 70.95565 + 99.26330], recall=[0.13520, 0.31282], precision=[0.01421, 0.00724], hit=[0.23745, 0.48756], ndcg=[0.08935, 0.14679]
Epoch 599 [108.5s + 54.8s]: train==[190.27020=20.06078 + 70.98073 + 99.22869], recall=[0.13614, 0.31267], precision=[0.01431, 0.00724], hit=[0.23912, 0.48743], ndcg=[0.09025, 0.14754]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 600 [107.1s]: train==[190.34215=20.16607 + 70.95035 + 99.22573]
Epoch 609 [108.7s + 54.9s]: train==[190.35482=20.18792 + 70.94699 + 99.21991], recall=[0.13538, 0.31162], precision=[0.01426, 0.00721], hit=[0.23861, 0.48682], ndcg=[0.09029, 0.14759]
Epoch 619 [107.3s + 54.7s]: train==[190.20591=20.05884 + 70.90471 + 99.24235], recall=[0.13568, 0.31284], precision=[0.01423, 0.00725], hit=[0.23827, 0.48808], ndcg=[0.09046, 0.14795]
Epoch 629 [108.0s + 54.9s]: train==[190.33367=20.10035 + 71.01411 + 99.21921], recall=[0.13551, 0.31319], precision=[0.01424, 0.00725], hit=[0.23836, 0.48879], ndcg=[0.09031, 0.14794]
Epoch 639 [106.6s + 54.9s]: train==[190.30025=20.13650 + 70.94010 + 99.22364], recall=[0.13567, 0.31228], precision=[0.01425, 0.00722], hit=[0.23766, 0.48758], ndcg=[0.09004, 0.14746]
Epoch 649 [108.6s + 55.5s]: train==[190.21075=20.09398 + 70.89048 + 99.22629], recall=[0.13665, 0.31320], precision=[0.01434, 0.00724], hit=[0.24047, 0.48802], ndcg=[0.09053, 0.14771]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 650 [106.4s]: train==[190.22017=20.05062 + 70.95174 + 99.21781]
Epoch 659 [106.9s + 54.9s]: train==[190.16027=20.05022 + 70.88393 + 99.22612], recall=[0.13672, 0.31340], precision=[0.01437, 0.00726], hit=[0.24087, 0.48858], ndcg=[0.09104, 0.14827]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 669 [108.1s + 54.3s]: train==[190.14163=20.03825 + 70.91163 + 99.19176], recall=[0.13579, 0.31365], precision=[0.01424, 0.00726], hit=[0.23827, 0.48883], ndcg=[0.09091, 0.14851]
Epoch 679 [107.0s + 55.6s]: train==[190.22003=20.09916 + 70.91519 + 99.20569], recall=[0.13608, 0.31355], precision=[0.01429, 0.00726], hit=[0.23936, 0.48909], ndcg=[0.09010, 0.14761]
Epoch 689 [107.0s + 54.5s]: train==[190.29888=20.13034 + 70.95410 + 99.21443], recall=[0.13470, 0.31325], precision=[0.01417, 0.00726], hit=[0.23687, 0.48818], ndcg=[0.09026, 0.14806]
Epoch 699 [107.6s + 55.3s]: train==[190.22775=20.07032 + 70.94552 + 99.21191], recall=[0.13524, 0.31335], precision=[0.01423, 0.00725], hit=[0.23764, 0.48875], ndcg=[0.09017, 0.14778]
Epoch 700 [105.1s]: train==[190.37444=20.25045 + 70.92669 + 99.19730]
Epoch 709 [105.8s + 55.3s]: train==[190.18336=20.07989 + 70.90962 + 99.19385], recall=[0.13467, 0.31267], precision=[0.01410, 0.00724], hit=[0.23622, 0.48788], ndcg=[0.08936, 0.14710]
Epoch 719 [108.3s + 55.6s]: train==[190.20490=20.10329 + 70.91088 + 99.19073], recall=[0.13507, 0.31222], precision=[0.01419, 0.00723], hit=[0.23749, 0.48807], ndcg=[0.08990, 0.14751]
Epoch 729 [108.0s + 54.7s]: train==[190.07246=20.01016 + 70.88557 + 99.17673], recall=[0.13459, 0.31292], precision=[0.01416, 0.00725], hit=[0.23632, 0.48858], ndcg=[0.08938, 0.14714]
Epoch 739 [106.2s + 56.1s]: train==[190.09402=20.04143 + 70.85802 + 99.19457], recall=[0.13552, 0.31348], precision=[0.01422, 0.00726], hit=[0.23819, 0.48921], ndcg=[0.09000, 0.14781]
Epoch 749 [107.8s + 55.0s]: train==[190.14629=20.04559 + 70.91727 + 99.18343], recall=[0.13730, 0.31396], precision=[0.01442, 0.00727], hit=[0.24148, 0.48926], ndcg=[0.09127, 0.14856]
save the weights in path:  weights/amazon-book/cke/l0.0001_r1e-05-1e-05
Epoch 750 [107.7s]: train==[190.15274=20.06273 + 70.89938 + 99.19064]
Epoch 759 [107.7s + 54.8s]: train==[190.06182=20.00726 + 70.87206 + 99.18250], recall=[0.13573, 0.31318], precision=[0.01423, 0.00724], hit=[0.23786, 0.48867], ndcg=[0.09061, 0.14822]
Epoch 769 [108.8s + 55.2s]: train==[190.12624=20.07257 + 70.87075 + 99.18292], recall=[0.13575, 0.31408], precision=[0.01425, 0.00727], hit=[0.23836, 0.48974], ndcg=[0.09001, 0.14772]
Epoch 779 [109.6s + 55.5s]: train==[190.17847=20.08541 + 70.91435 + 99.17871], recall=[0.13559, 0.31499], precision=[0.01426, 0.00728], hit=[0.23837, 0.49121], ndcg=[0.09075, 0.14876]
Epoch 789 [105.4s + 55.3s]: train==[190.20265=20.09369 + 70.92096 + 99.18800], recall=[0.13431, 0.31431], precision=[0.01407, 0.00727], hit=[0.23626, 0.49043], ndcg=[0.08952, 0.14790]
Epoch 799 [107.7s + 55.7s]: train==[189.97648=19.99193 + 70.80883 + 99.17571], recall=[0.13557, 0.31431], precision=[0.01425, 0.00727], hit=[0.23898, 0.49086], ndcg=[0.09051, 0.14843]
Epoch 800 [108.3s]: train==[190.15786=20.06552 + 70.90902 + 99.18332]
Epoch 809 [105.6s + 55.0s]: train==[190.10444=20.08271 + 70.85338 + 99.16835], recall=[0.13518, 0.31460], precision=[0.01422, 0.00728], hit=[0.23808, 0.49095], ndcg=[0.09074, 0.14897]
Epoch 819 [108.1s + 55.8s]: train==[190.05293=20.00390 + 70.88400 + 99.16502], recall=[0.13611, 0.31470], precision=[0.01430, 0.00729], hit=[0.24027, 0.49077], ndcg=[0.09037, 0.14816]
Epoch 829 [106.6s + 55.6s]: train==[189.99520=19.97370 + 70.85813 + 99.16337], recall=[0.13548, 0.31416], precision=[0.01423, 0.00727], hit=[0.23849, 0.49069], ndcg=[0.09065, 0.14871]
Epoch 839 [107.2s + 56.0s]: train==[190.11969=20.08975 + 70.85292 + 99.17701], recall=[0.13646, 0.31427], precision=[0.01433, 0.00728], hit=[0.24003, 0.49080], ndcg=[0.09043, 0.14812]
Epoch 849 [106.8s + 54.9s]: train==[189.99588=19.98478 + 70.86067 + 99.15044], recall=[0.13563, 0.31522], precision=[0.01427, 0.00730], hit=[0.23897, 0.49142], ndcg=[0.09042, 0.14856]
Early stopping is trigger at step: 10 log:0.13563444991951776
Best Iter=[74]@[95633.3]	recall=[0.13730	0.20141	0.24680	0.28300	0.31396], precision=[0.01442	0.01100	0.00922	0.00807	0.00727], hit=[0.24148	0.34072	0.40456	0.45247	0.48926], ndcg=[0.09127	0.11395	0.12848	0.13954	0.14856]
Sat Jan  9 17:19:26 PST 2021
Running model_type=cke on dataset=last-fm
Num cores: 20
[n_users, n_items]=[23566, 48123]
[n_train, n_test]=[1289003, 423635]
[n_entities, n_relations, n_triples]=[106389, 9, 464567]
[batch_size, batch_size_kg]=[1024, 369]
load the pretrained bprmf model parameters.
using pretrained initialization
#params: 11434432
without pretraining.
Epoch 0 [82.5s]: train==[577.46372=55.19447 + 406.13000 + 116.13925]
Epoch 9 [81.2s + 32.3s]: train==[299.76292=54.84360 + 129.21718 + 115.70214], recall=[0.07247, 0.15456], precision=[0.03017, 0.01607], hit=[0.32186, 0.57698], ndcg=[0.11685, 0.20120]
save the weights in path:  weights/last-fm/cke/l0.0001_r1e-05-1e-05
Epoch 19 [79.6s + 32.0s]: train==[284.40108=54.56515 + 114.38120 + 115.45472], recall=[0.07274, 0.15443], precision=[0.03032, 0.01608], hit=[0.32297, 0.57625], ndcg=[0.11755, 0.20149]
save the weights in path:  weights/last-fm/cke/l0.0001_r1e-05-1e-05
Epoch 29 [79.9s + 31.5s]: train==[279.23266=54.72774 + 109.16492 + 115.34000], recall=[0.07330, 0.15489], precision=[0.03056, 0.01612], hit=[0.32449, 0.57681], ndcg=[0.11814, 0.20192]
save the weights in path:  weights/last-fm/cke/l0.0001_r1e-05-1e-05
Epoch 39 [80.4s + 31.5s]: train==[276.85666=54.59920 + 107.00527 + 115.25219], recall=[0.07293, 0.15531], precision=[0.03042, 0.01619], hit=[0.32233, 0.57765], ndcg=[0.11788, 0.20237]
Epoch 49 [81.2s + 31.6s]: train==[274.88773=54.28785 + 105.40719 + 115.19268], recall=[0.07326, 0.15577], precision=[0.03065, 0.01621], hit=[0.32390, 0.57867], ndcg=[0.11813, 0.20241]
Epoch 50 [79.9s]: train==[274.84366=54.47424 + 105.18691 + 115.18251]
Epoch 59 [80.7s + 31.9s]: train==[273.59857=54.24795 + 104.18562 + 115.16500], recall=[0.07301, 0.15535], precision=[0.03055, 0.01621], hit=[0.32292, 0.57748], ndcg=[0.11770, 0.20202]
Epoch 69 [79.5s + 31.7s]: train==[273.03905=54.26198 + 103.64615 + 115.13092], recall=[0.07303, 0.15559], precision=[0.03051, 0.01621], hit=[0.32326, 0.57757], ndcg=[0.11754, 0.20185]
Epoch 79 [81.6s + 61.6s]: train==[272.38369=54.27177 + 103.00172 + 115.11020], recall=[0.07289, 0.15536], precision=[0.03040, 0.01621], hit=[0.32297, 0.57859], ndcg=[0.11788, 0.20254]
Epoch 89 [81.7s + 31.7s]: train==[272.18442=54.43318 + 102.64642 + 115.10483], recall=[0.07246, 0.15533], precision=[0.03046, 0.01620], hit=[0.32301, 0.57774], ndcg=[0.11766, 0.20211]
Epoch 99 [83.6s + 31.8s]: train==[271.72089=54.30574 + 102.32738 + 115.08778], recall=[0.07289, 0.15586], precision=[0.03057, 0.01623], hit=[0.32254, 0.57948], ndcg=[0.11741, 0.20209]
Epoch 100 [84.7s]: train==[271.28743=54.04261 + 102.15879 + 115.08603]
Epoch 109 [81.9s + 31.3s]: train==[271.07501=54.15215 + 101.85228 + 115.07057], recall=[0.07294, 0.15580], precision=[0.03041, 0.01623], hit=[0.32229, 0.57910], ndcg=[0.11767, 0.20249]
Epoch 119 [80.0s + 31.7s]: train==[270.88079=54.09941 + 101.70419 + 115.07719], recall=[0.07307, 0.15557], precision=[0.03062, 0.01620], hit=[0.32258, 0.57774], ndcg=[0.11813, 0.20241]
Epoch 129 [80.7s + 31.1s]: train==[270.43910=53.98784 + 101.40596 + 115.04530], recall=[0.07296, 0.15573], precision=[0.03056, 0.01622], hit=[0.32229, 0.57939], ndcg=[0.11768, 0.20248]
Early stopping is trigger at step: 10 log:0.07296323354933673
Best Iter=[2]@[11002.4]	recall=[0.07330	0.10314	0.12444	0.14065	0.15489], precision=[0.03056	0.02381	0.02016	0.01778	0.01612], hit=[0.32449	0.43054	0.49516	0.54078	0.57681], ndcg=[0.11814	0.14932	0.17061	0.18738	0.20192]
Sat Jan  9 20:23:18 PST 2021
Running model_type=cke on dataset=yelp2018
Num cores: 20
[n_users, n_items]=[45919, 45538]
[n_train, n_test]=[930032, 253578]
[n_entities, n_relations, n_triples]=[136499, 42, 1853704]
[batch_size, batch_size_kg]=[1024, 2041]
load the pretrained bprmf model parameters.
using pretrained initialization
#params: 14763904
without pretraining.
Epoch 0 [96.2s]: train==[265.90043=35.74335 + 127.42165 + 102.73543]
Epoch 9 [95.4s + 59.2s]: train==[225.45778=35.66943 + 87.27847 + 102.50987], recall=[0.06527, 0.19095], precision=[0.01588, 0.00962], hit=[0.25127, 0.54218], ndcg=[0.08074, 0.15498]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 19 [97.4s + 59.0s]: train==[215.69636=35.48072 + 77.83769 + 102.37796], recall=[0.06475, 0.19219], precision=[0.01578, 0.00969], hit=[0.25001, 0.54366], ndcg=[0.08013, 0.15516]
Epoch 29 [96.7s + 58.3s]: train==[211.75776=35.66548 + 73.78499 + 102.30730], recall=[0.06547, 0.19239], precision=[0.01595, 0.00971], hit=[0.25158, 0.54377], ndcg=[0.08046, 0.15524]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 39 [93.2s + 57.6s]: train==[209.21216=35.29054 + 71.65348 + 102.26814], recall=[0.06568, 0.19231], precision=[0.01601, 0.00972], hit=[0.25315, 0.54375], ndcg=[0.08106, 0.15571]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 49 [94.2s + 57.7s]: train==[208.20527=35.48068 + 70.48746 + 102.23712], recall=[0.06577, 0.19231], precision=[0.01601, 0.00971], hit=[0.25232, 0.54338], ndcg=[0.08141, 0.15597]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 50 [94.1s]: train==[207.87681=35.41508 + 70.22579 + 102.23594]
Epoch 59 [95.6s + 58.4s]: train==[206.84491=35.25553 + 69.36542 + 102.22397], recall=[0.06537, 0.19252], precision=[0.01585, 0.00971], hit=[0.25127, 0.54443], ndcg=[0.08004, 0.15503]
Epoch 69 [93.9s + 57.3s]: train==[206.09574=35.47922 + 68.41638 + 102.20015], recall=[0.06515, 0.19268], precision=[0.01590, 0.00972], hit=[0.25145, 0.54417], ndcg=[0.08027, 0.15524]
Epoch 79 [94.8s + 57.9s]: train==[205.34982=35.34814 + 67.80000 + 102.20168], recall=[0.06518, 0.19277], precision=[0.01587, 0.00974], hit=[0.25023, 0.54451], ndcg=[0.08029, 0.15544]
Epoch 89 [94.6s + 57.2s]: train==[204.68452=35.31868 + 67.17621 + 102.18964], recall=[0.06597, 0.19323], precision=[0.01599, 0.00974], hit=[0.25269, 0.54584], ndcg=[0.08114, 0.15600]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 99 [95.0s + 57.0s]: train==[204.66836=35.57959 + 66.92553 + 102.16324], recall=[0.06555, 0.19281], precision=[0.01591, 0.00974], hit=[0.25119, 0.54449], ndcg=[0.08115, 0.15610]
Epoch 100 [94.6s]: train==[204.33731=35.27983 + 66.89962 + 102.15786]
Epoch 109 [98.0s + 57.7s]: train==[204.11055=35.47850 + 66.46649 + 102.16556], recall=[0.06511, 0.19239], precision=[0.01586, 0.00972], hit=[0.25025, 0.54484], ndcg=[0.08044, 0.15560]
Epoch 119 [95.1s + 56.8s]: train==[203.76971=35.36966 + 66.25151 + 102.14854], recall=[0.06625, 0.19295], precision=[0.01608, 0.00976], hit=[0.25238, 0.54519], ndcg=[0.08115, 0.15597]
save the weights in path:  weights/yelp2018/cke/l0.0001_r1e-05-1e-05
Epoch 129 [94.8s + 57.1s]: train==[203.35240=35.36770 + 65.85229 + 102.13241], recall=[0.06581, 0.19308], precision=[0.01593, 0.00975], hit=[0.25223, 0.54525], ndcg=[0.08094, 0.15602]
Epoch 139 [94.9s + 56.3s]: train==[203.38178=35.56502 + 65.69254 + 102.12421], recall=[0.06533, 0.19274], precision=[0.01592, 0.00974], hit=[0.25151, 0.54552], ndcg=[0.08106, 0.15614]
Epoch 149 [95.3s + 57.9s]: train==[203.09195=35.40927 + 65.54796 + 102.13471], recall=[0.06554, 0.19353], precision=[0.01598, 0.00977], hit=[0.25132, 0.54643], ndcg=[0.08109, 0.15645]
Epoch 150 [95.5s]: train==[202.96706=35.41377 + 65.42661 + 102.12668]
Epoch 159 [94.7s + 57.2s]: train==[202.65280=35.38788 + 65.14802 + 102.11689], recall=[0.06513, 0.19240], precision=[0.01584, 0.00972], hit=[0.25180, 0.54480], ndcg=[0.08046, 0.15554]
Epoch 169 [95.1s + 57.6s]: train==[202.66795=35.37479 + 65.16263 + 102.13054], recall=[0.06554, 0.19306], precision=[0.01596, 0.00975], hit=[0.25228, 0.54621], ndcg=[0.08067, 0.15585]
Epoch 179 [94.6s + 58.3s]: train==[202.29927=35.30704 + 64.87548 + 102.11675], recall=[0.06577, 0.19330], precision=[0.01591, 0.00977], hit=[0.25234, 0.54560], ndcg=[0.08092, 0.15610]
Epoch 189 [94.6s + 56.7s]: train==[201.85234=35.12563 + 64.61141 + 102.11530], recall=[0.06623, 0.19313], precision=[0.01607, 0.00975], hit=[0.25308, 0.54647], ndcg=[0.08101, 0.15592]
Epoch 199 [95.0s + 58.0s]: train==[202.04783=35.38458 + 64.55142 + 102.11183], recall=[0.06551, 0.19326], precision=[0.01584, 0.00975], hit=[0.25060, 0.54665], ndcg=[0.07985, 0.15536]
Epoch 200 [96.9s]: train==[201.97348=35.35369 + 64.50503 + 102.11476]
Epoch 209 [93.1s + 58.0s]: train==[201.95471=35.31676 + 64.51785 + 102.12010], recall=[0.06612, 0.19298], precision=[0.01609, 0.00974], hit=[0.25382, 0.54582], ndcg=[0.08220, 0.15689]
Epoch 219 [94.9s + 57.0s]: train==[201.57220=35.22645 + 64.24621 + 102.09955], recall=[0.06550, 0.19311], precision=[0.01597, 0.00974], hit=[0.25215, 0.54615], ndcg=[0.08096, 0.15606]
Early stopping is trigger at step: 10 log:0.06550117047951505
Best Iter=[11]@[22187.8]	recall=[0.06625	0.10759	0.14101	0.16913	0.19295], precision=[0.01608	0.01323	0.01168	0.01060	0.00976], hit=[0.25238	0.36770	0.44577	0.50324	0.54519], ndcg=[0.08115	0.10834	0.12795	0.14344	0.15597]
Finished